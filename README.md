# üöÄ –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–ø–æ—Å—Ç–∏–Ω–≥–∞ –Ω–∞ Firebase

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –Ω–∞ xfree.com —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Firebase Cloud Functions.

## üìã –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—É–±–ª–∏–∫–∞—Ü–∏—è –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é
- ‚úÖ –•—Ä–∞–Ω–µ–Ω–∏–µ –≤–∏–¥–µ–æ –≤ Firebase Storage
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Firestore Database
- ‚úÖ HTTP API –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Å—Ç–æ–≤
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä–æ–≤
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
Firebase Cloud Functions
    ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  check_scheduled_posts (–∫–∞–∂–¥—É—é –º–∏–Ω) ‚îÇ
‚îÇ  ‚Üì                                   ‚îÇ
‚îÇ  Firestore (posts collection)       ‚îÇ
‚îÇ  ‚Üì                                   ‚îÇ
‚îÇ  xfree_poster.py (Playwright)       ‚îÇ
‚îÇ  ‚Üì                                   ‚îÇ
‚îÇ  xfree.com                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
autopost-firebase/
‚îú‚îÄ‚îÄ functions/
‚îÇ   ‚îú‚îÄ‚îÄ main.py              # Cloud Functions
‚îÇ   ‚îú‚îÄ‚îÄ xfree_poster.py      # –ú–æ–¥—É–ª—å –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt     # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îÇ   ‚îî‚îÄ‚îÄ .env.example         # –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ firestore.rules          # –ü—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Firestore
‚îú‚îÄ‚îÄ firestore.indexes.json   # –ò–Ω–¥–µ–∫—Å—ã Firestore
‚îú‚îÄ‚îÄ storage.rules            # –ü—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Storage
‚îú‚îÄ‚îÄ firebase.json            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Firebase
‚îú‚îÄ‚îÄ .firebaserc              # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ .gitignore               # Git ignore
‚îú‚îÄ‚îÄ README.md                # –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îî‚îÄ‚îÄ SETUP_GUIDE.md           # –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- –ê–∫–∫–∞—É–Ω—Ç Firebase (—Å –ø–ª–∞—Ç–Ω—ã–º –ø–ª–∞–Ω–æ–º Blaze)
- –ê–∫–∫–∞—É–Ω—Ç GitHub
- –ë—Ä–∞—É–∑–µ—Ä (–¥–ª—è —Ä–∞–±–æ—Ç—ã —á–µ—Ä–µ–∑ GitHub Codespaces –Ω–∞ iPad)

### 2. –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ GitHub Codespaces (–¥–ª—è iPad)

1. –û—Ç–∫—Ä–æ–π—Ç–µ —ç—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub
2. –ù–∞–∂–º–∏—Ç–µ **Code** ‚Üí **Create codespace on main**
3. –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ Codespaces –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Firebase CLI
npm install -g firebase-tools

# –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ Firebase
firebase login --no-localhost

# –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
firebase deploy
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Firestore

–°–æ–∑–¥–∞–π—Ç–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –≤ Firestore Console:

#### –ö–æ–ª–ª–µ–∫—Ü–∏—è `accounts`

```json
{
  "email": "your@email.com",
  "password": "your_password",
  "platform": "xfree",
  "proxy": null,
  "status": "active"
}
```

#### –ö–æ–ª–ª–µ–∫—Ü–∏—è `posts`

```json
{
  "account_id": "account_doc_id",
  "title": "Post title",
  "description": "Post description",
  "video_url": "gs://bucket/videos/video.mp4",
  "scheduled_time": "2025-11-05T15:00:00Z",
  "status": "pending",
  "platform": "xfree"
}
```

### 4. –ó–∞–≥—Ä—É–∑–∫–∞ –≤–∏–¥–µ–æ –≤ Storage

–ß–µ—Ä–µ–∑ Firebase Console:
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Storage**
2. –°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É `videos`
3. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤–∏–¥–µ–æ —Ñ–∞–π–ª—ã

### 5. –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–∞ —á–µ—Ä–µ–∑ API

```bash
curl -X POST https://YOUR-REGION-YOUR-PROJECT.cloudfunctions.net/create_post \
  -H "Content-Type: application/json" \
  -d '{
    "account_id": "your_account_doc_id",
    "title": "Test Post",
    "description": "This is a test post",
    "video_url": "gs://your-project.appspot.com/videos/test.mp4",
    "scheduled_time": "2025-11-05T15:00:00Z"
  }'
```

## üìä API Endpoints

### POST /create_post

–°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ—Å—Ç.

**Request:**
```json
{
  "account_id": "string",
  "title": "string",
  "description": "string",
  "video_url": "string",
  "scheduled_time": "ISO 8601 datetime"
}
```

**Response:**
```json
{
  "success": true,
  "post_id": "generated_post_id"
}
```

### GET /get_posts

–ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –ø–æ—Å—Ç–æ–≤.

**Query Parameters:**
- `status` - —Ñ–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É (pending, published, failed, all)
- `limit` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å—Ç–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 50)

**Response:**
```json
{
  "success": true,
  "posts": [...],
  "count": 10
}
```

### POST /retry_failed_post

–ü–æ–≤—Ç–æ—Ä—è–µ—Ç –ø–æ–ø—ã—Ç–∫—É –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –Ω–µ—É–¥–∞–≤—à–µ–≥–æ—Å—è –ø–æ—Å—Ç–∞.

**Request:**
```json
{
  "post_id": "string"
}
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏

–í `functions/main.py`:

```python
@scheduler_fn.on_schedule(schedule="every 5 minutes")  # –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞ –Ω—É–∂–Ω–æ–µ
def check_scheduled_posts(event: scheduler_fn.ScheduledEvent) -> None:
    ...
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–∫—Å–∏

–í –¥–æ–∫—É–º–µ–Ω—Ç–µ –∞–∫–∫–∞—É–Ω—Ç–∞ –≤ Firestore:

```json
{
  "proxy": "http://username:password@proxy-server:port"
}
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ xfree.com

–í `functions/xfree_poster.py` –∏–∑–º–µ–Ω–∏—Ç–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ä–µ–∞–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π —Å–∞–π—Ç–∞:

```python
title_selector = 'input[name="title"]'  # –í–∞—à —Å–µ–ª–µ–∫—Ç–æ—Ä
desc_selector = 'textarea[name="description"]'  # –í–∞—à —Å–µ–ª–µ–∫—Ç–æ—Ä
```

## üìù –õ–æ–≥–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

```bash
# –í—Å–µ –ª–æ–≥–∏
firebase functions:log

# –õ–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
firebase functions:log --only check_scheduled_posts

# –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
firebase functions:log --follow
```

### –í Firebase Console

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Functions**
2. –í—ã–±–µ—Ä–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é
3. –ù–∞–∂–º–∏—Ç–µ **Logs**

## üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å

### –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å (Free Tier)

- 2 –º–ª–Ω –≤—ã–∑–æ–≤–æ–≤ Cloud Functions/–º–µ—Å—è—Ü
- 5 GB Storage
- 50,000 reads Firestore/–¥–µ–Ω—å
- 20,000 writes Firestore/–¥–µ–Ω—å

### –ü—Ä–∏–º–µ—Ä–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–ª—è 100 –ø–æ—Å—Ç–æ–≤/–¥–µ–Ω—å

- Cloud Functions: ~$2/–º–µ—Å—è—Ü
- Storage: ~$1/–º–µ—Å—è—Ü
- Firestore: ~$1/–º–µ—Å—è—Ü
- **–ò—Ç–æ–≥–æ: ~$4-5/–º–µ—Å—è—Ü**

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –§—É–Ω–∫—Ü–∏—è –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `firebase functions:log`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—Ä–æ–µ–∫—Ç –Ω–∞ –ø–ª–∞—Ç–Ω–æ–º –ø–ª–∞–Ω–µ Blaze
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ Firestore –∏ Storage

### –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –≤ `xfree_poster.py`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∞–∫–∫–∞—É–Ω—Ç –∞–∫—Ç–∏–≤–µ–Ω
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–æ–∫—Å–∏ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

### –í–∏–¥–µ–æ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ Storage
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—É—Ç—å –∫ –≤–∏–¥–µ–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ (–ª–∏–º–∏—Ç Firebase Storage)

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚ö†Ô∏è **–ù–ï —Ö—Ä–∞–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª–∏ –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
- ‚ö†Ô∏è **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ Firestore** - –æ–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø
- ‚ö†Ô∏è **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–æ–∫—Å–∏** - –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ —Å–≤–æ–π –ø—Ä–æ–∫—Å–∏
- ‚ö†Ô∏è **–í–∫–ª—é—á–∏—Ç–µ 2FA** - –¥–ª—è Firebase Console

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [Firebase Documentation](https://firebase.google.com/docs)
- [Playwright Documentation](https://playwright.dev/python/)
- [SETUP_GUIDE.md](./SETUP_GUIDE.md) - –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è iPad

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–∞ —Å–≤–æ–µ —É—Å–º–æ—Ç—Ä–µ–Ω–∏–µ

## ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã, —Å–æ–∑–¥–∞–π—Ç–µ Issue –≤ —ç—Ç–æ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.

---

**–°–æ–∑–¥–∞–Ω–æ —Å ‚ù§Ô∏è –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞**
